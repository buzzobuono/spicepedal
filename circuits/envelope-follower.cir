* Alimentazione
VCC 10 0 DC 9
VEE 11 0 DC -9

* --- Ingresso + Buffer ---
C_in 1 2 0.1u
R_in 2 0 47k
O1 3 2 3 10 11 TL072 Rout=75 Imax=0.020 Gain=10000 Sr=13

* --- Envelope Follower ---
* Diodo low-threshold per 15 mV input
D1 3 4 D_LOW Is=2e-5 N=1 Vt=0.02585 Cj0=1.15e-12 Vj=0.74 Mj=0.02

C1 4 0 1u
R1 4 0 47k

* Primo stadio envelope-controlled filter stabilizzato
R_mod1 3 5 47k       ; segnale audio
R_mod2 5 4 100k      ; envelope
C_mod1 5 6 0.002u    ; condensatore pi√π piccolo per convergenza
O2 6 5 6 10 11 TL072 Rout=75 Imax=0.020 Gain=1 Sr=13

.probe envelope_follower.csv V(1) V(4) V(6)
.output 6
.input 1
.warmup 5